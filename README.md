# GAN MNIST Digit Generator with FastAPI

My submission trains a Generative Adversarial Network (GAN) on the MNIST dataset to generate novel handwritten digits. The trained generator is then accessed via a RESTful API built with FastAPI, all containerized with Docker.

---
## Features

* **PyTorch GAN**: A Generator and Discriminator matching the assignment's architecture, trained on MNIST.
* **Helper Library**: Code is modularized into a `helper_lib` for data loading, model definitions, training, and image generation.
* **FastAPI Server**: A robust API with multiple endpoints to serve the trained generator.
* **Dockerized**: A `Dockerfile` is included (with the `PYTHONPATH` fix) to build a portable container that runs reliably.
* **uv as a Package manager**: Uses `uv` for fast and efficient Python package management.

---
## Project Structure

The repository is organized to separate the core ML logic from the API service.

```

.
├── app/                  \# Contains the FastAPI application
│   └── main.py
├── data/                 \# (Generated by train.py) MNIST dataset
├── helper\_lib/           \# Reusable library for ML tasks
│   ├── data\_loader.py
│   ├── image\_generator.py  \# Utility to save generated image grids
│   ├── model.py            \# GAN Generator and Discriminator models
│   └── trainer.py          \# GAN training loop
├── .gitignore            \# Specifies files for Git to ignore
├── Dockerfile            \# Instructions to build the Docker container
├── pyproject.toml        \# Project dependencies for uv
├── train.py              \# Script to train the GAN
│
├── gan\_generator.pth       \# (Generated by train.py) Saved generator weights
├── gan\_discriminator.pth   \# (Generated by train.py) Saved discriminator weights

````

---
## How to Run This Project

Follow these steps to set up the environment, train the model, and run the API.

### Prerequisites

* Python 3.12+
* [uv](https://astral.sh/uv) Package Manager
* [Docker Desktop](https://www.docker.com/products/docker-desktop/)

### Step 1: Setup Environment

After cloning the repository, create a virtual environment and install all dependencies using `uv`.

```bash
# Navigate to the project directory
cd genai_assignment3

# Create the virtual environment
uv venv

# Install packages from the pyproject.toml file
uv pip install -r pyproject.toml
````

### Step 2: Train the Model

Before running the API, you must train the GAN. This script will download the MNIST dataset into a `./data` folder and save the trained model weights (`gan_generator.pth` and `gan_discriminator.pth`) in the root directory.

**NOTE:** This has already been done, so can just jump to the next step 

Run the training script using `uv`:

```bash
uv run python train.py
```

*(This may take some time. You can monitor progress by checking the `epoch_..._samples.png` files that are generated).*

### Step 3: Run the API

You can run the API either locally for testing or inside the Docker container.

#### Option A: Run Locally (for testing)

This runs the server directly on your machine.

```bash
uv run uvicorn app.main:app --host 0.0.0.0 --port 8000
```

#### Option B: Run with Docker (for submission)

This builds and runs the self-contained Docker image.

```bash
# 1. Build the Docker image
docker build -t gan-digit-app .

# 2. Run the Docker container
docker run -p 8000:8000 gan-digit-app
```
-----

## API Endpoints

Once the server is running (using either method), the following endpoints are available:

### `GET /`

  * **Description**: A simple welcome message.
  * **URL**: `http://127.0.0.1:8000/`

### `GET /generate`

  * **Description**: Generates a **single** random handwritten digit and returns it as a PNG image.
  * **URL**: `http://127.0.0.1:8000/generate`
  * **Try it**: Open this URL in your browser. Every refresh will generate a new digit.

### `GET /generate_grid`

  * **Description**: Generates a **grid** of `n` random handwritten digits.
  * **URL**: `http://127.0.0.1:8000/generate_grid`
  * **Query Parameter**:
      * `count` (integer): The number of digits you want to generate.
      * **Default**: 9
      * **Max**: 100
  * **Example**: To generate a grid of 16 digits, open this URL in your browser:
    `http://127.0.0.1:8000/generate_grid?count=16`

### A Note on Functionality

This is an **unconditional GAN**. It learns to generate realistic digits from a random noise vector. It does *not* have the ability to generate a *specific* digit (e.g., "generate an 8"). That functionality would require a **Conditional GAN (cGAN)**, which is a different architecture that is trained with image labels.